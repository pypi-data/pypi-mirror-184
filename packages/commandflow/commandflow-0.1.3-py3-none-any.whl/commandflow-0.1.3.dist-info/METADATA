Metadata-Version: 2.1
Name: commandflow
Version: 0.1.3
Summary: Writing shell by python.
Home-page: https://github.com/dwpeng/commandflow
Author: dwpeng
Author-email: 1732889554@qq.com
Requires-Python: >=3.7,<4.0
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Project-URL: Repository, https://github.com/dwpeng/commandflow
Description-Content-Type: text/markdown

# commandflow

ä½¿ç”¨Pythonç”Ÿæˆå‘½ä»¤è¡Œ

## ðŸ• å®‰è£…
```bash
pip install commandflow
```

## ðŸŽ‰ å¿«é€Ÿå¼€å§‹

```py
from commandflow import Command
class MyCommand(Command):
    exe = 'fastp'

    def input(self, filename):
        self.set_action('f', 'file', value=filename)

if __name__ == '__main__':
    command = MyCommand()
    command.input('test.file')
    print(command.command)  # fastp --file test.file
```

## âœ¨æ–‡æ¡£

### è®¾è®¡åŠ¨æœº
1. åœ¨è¿›è¡Œç”Ÿä¿¡åˆ†æžæ—¶ï¼Œå¾€å¾€ä¼šä½¿ç”¨å¾ˆå¤šåˆ†æžè½¯ä»¶ï¼Œå½“ä¸²è”ä¸€ä¸ªå®Œæ•´çš„åˆ†æžæµç¨‹æ—¶ï¼Œéœ€è¦ç¼–å†™å¤§é‡çš„shellè„šæœ¬ï¼Œè¿™å¾ˆä¸ä¼˜é›…ã€‚
2. æˆ‘ä¸å–œæ¬¢å†™shellã€‚


### å±‚æ¬¡ç»“æž„
![](./assert/layout.svg)
å¯¹äºŽæ¯ä¸€æ¡å‘½ä»¤Commandè€Œè¨€ï¼Œæ˜¯ç”±è‹¥å¹²ä¸ªActionç»„æˆï¼Œæ¯ä¸€ä¸ªActionä¸ºä¸€ä¸ªå‚æ•°ã€‚

### åˆ›å»ºä¸€ä¸ªå‘½ä»¤
```py
from commandflow import Command
class MyCommand(Command):
    exe = 'bwa'  # æŒ‡å®šå¯æ‰§è¡Œç¨‹åº
```
æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡`set_exe()`æ¥æŒ‡å®šå¯æ‰§è¡Œç¨‹åº
```py
from commandflow import Command
class MyCommand(Command):
    exe = 'bwa'  # æŒ‡å®šå¯æ‰§è¡Œç¨‹åº

c = MyCommand()
c.set_exe('bwa')
```
### æ·»åŠ å‚æ•°
ä½¿ç”¨`set_action()`æ¥æ·»åŠ å‚æ•°åˆ°æœ€ç»ˆçš„å‘½ä»¤è¡Œä¸­
```py
from commandflow import Command
class MyCommand(Command):
    exe = 'bwa'

    def input(self, filename):
        self.set_action(
            'f',
            'file',
            value=filename
        )

c = MyCommand()
c.input('test.docx')
```
`set_action()`å¯ä»¥æŽ¥æ”¶å¤šä¸ªå‚æ•°
```txt
- short_arg_nameï¼š çŸ­å‚æ•°å  -f
- long_arg_nameï¼š é•¿å‚æ•°å  --file
- valueï¼šå‚æ•°å€¼
- helpï¼šå¯¹è¯¥æ¡å‚æ•°çš„è§£é‡Šè¯´æ˜Ž
- positionalï¼šä½¿ç”¨æ˜¯ä¸€ä¸ªä½ç½®å‚æ•°ï¼Œé»˜è®¤æ”¾åˆ°æœ€åŽ
- sepï¼šå½“ä¼ é€’çš„valueæ˜¯ä¸€ä¸ªlistçš„æ—¶å€™ï¼Œæ‰€æŒ‡å®šçš„è¿žæŽ¥ç¬¦ï¼Œé»˜è®¤ä¸ºç©ºæ ¼
- stdoutï¼šå‘½ä»¤æ˜¯å¦éœ€è¦æŒ‡å®šæ ‡å‡†è¾“å‡º
```
`value`å¯ä»¥ä¸º`int`ã€`float`ã€`str`ã€`list`ç±»åž‹çš„å€¼ï¼Œå½“`value`æ˜¯ä¸€ä¸ª`list`ç±»åž‹çš„å€¼æ—¶ï¼Œä¼šé€šè¿‡`sep`è¿žæŽ¥èµ·æ¥ï¼Œå¦‚å½“`sep`ä¸ºç©ºæ ¼æ—¶ï¼Œ`[1, 2, 3]`ä¼šè¢«æ‹¼æŽ¥ä¸º`1 2 3`ï¼Œè¿™å¯¹æŸäº›æŽ¥æ”¶å¤šä¸ªå‚æ•°å€¼çš„å‚æ•°éžå¸¸æœ‰ç”¨ã€‚


### èŽ·å–æœ€ç»ˆçš„å‘½ä»¤è¡Œ
```py
from commandflow import Command
class MyCommand(Command):
    exe = 'bwa'

    def input(self, filename):
        self.set_action(
            'f',
            'file',
            value=filename
        )

c = MyCommand()
c.input('test.docx')
print(c.command)  # bwa --file test.docx
```
å½“ç›¸åŒçš„å‚æ•°å€¼è¢«å¤šæ¬¡è®¾ç½®å‚æ•°æ—¶ï¼ŒåŽé¢è®¾ç½®çš„ä¼šå°†å‰é¢è®¾ç½®çš„è¦†ç›–
```py
c = MyCommand()
c.input('test.docx')
c.input('apple.docx')
print(c.command)  # bwa --file apple.docx
```


### ç”Ÿæˆå¤šä¸ªå‘½ä»¤è¡Œ
ä¸Šé¢çš„æ–¹å¼åªèƒ½ç”Ÿæˆä¸€æ¡å‘½ä»¤ï¼Œä½†å®žé™…åº”ç”¨ä¸­å¯èƒ½ä¼šæ¶‰åŠåˆ°éœ€è¦ç”Ÿæˆå¤šæ¡å‘½ä»¤ï¼Œå½¼æ­¤ä¹‹é—´åªæ˜¯å‚æ•°å€¼ä¸åŒ

ä½¿ç”¨`record()`è®°å½•éœ€è¦ç”Ÿæˆçš„å‘½ä»¤ï¼Œå¹¶é€šè¿‡`records`æ¥èŽ·å–æ‰€æœ‰è®°å½•çš„å‘½ä»¤
```py
c = MyCommand()
for file in ['1.docx', '2.docx', '3.docx']:
    c.input(file)
    c.record()

print(c.records)  # ['bwa --file 1.docx', 'bwa --file 2.docx', 'bwa --file 3.docx']
```

### å°†æ‰€æœ‰å‘½ä»¤é‡ç½®ï¼ˆåˆ é™¤æ‰€æœ‰å‚æ•°ï¼‰
```py
c = MyCommand()
c.clear()
```


### æ›´æ”¹å‚æ•°å‰é¢çš„å‰ç¼€
æœ‰äº›è½¯ä»¶ä¸­ï¼Œå¯èƒ½å‚æ•°åå‰é¢ä¸æ˜¯`-`ã€`--`ï¼Œæ¯”å¦‚æŸäº›å‚æ•°åå¹¶ä¸æ˜¯åŒçŸ­çº¿è·Ÿç€é•¿å‚æ•°åï¼Œè€Œæ˜¯çŸ­çŸ­çº¿è·Ÿç€é•¿å‚æ•°åï¼Œå¦‚`-file test.docx`ã€‚å¯ä»¥åœ¨ç»§æ‰¿çš„ç±»ä¸­é€šè¿‡æ·»åŠ `long_dash`æ¥å£°æ˜Žé•¿å‚æ•°åçš„å‰ç¼€ï¼Œ`short_dash`æ¥å£°æ˜ŽçŸ­å‚æ•°åçš„å‰ç¼€ã€‚

```py
from commandflow import Command
class MyCommand(Command):
    long_dash = '-'
    short_dash = '-'
    exe = 'bwa'
```

### åŽå°ä»»åŠ¡
```py
c.nohup(nohup=True, nohup_log=False)
c.input('apple.docx')
print(c.command)
# nohup bwa --file apple.docx >/dev/null 2>&1
```

