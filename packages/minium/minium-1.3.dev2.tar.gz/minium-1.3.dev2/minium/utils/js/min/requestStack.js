function miniumRequestStack(){if(!global.__minium_request_stack){global.__minium_request_stack=new Map,global.__minium_wait_util=function(e=0,t=20){var _=(getCurrentPages().pop()||{}).__wxWebviewId__;return new Promise((a=>{var r=10*t,i=setInterval((()=>{r--;var t=global.__minium_request_stack.has(_)?global.__minium_request_stack.get(_).size:0;console.debug("[minitest] current stack size: ",t),t<=e?(clearInterval(i),a(!0)):r<0&&(clearInterval(i),a(!1))}),100)}))};var e=wx.request;Object.defineProperty(wx,"request",{configurable:!0,get:()=>function(t){if("https://weapp.tencent.com/jscov_driver/CollectCovTimer"==t.url)return e(t);var _,a=(getCurrentPages().pop()||{}).__wxWebviewId__;global.__minium_request_stack.has(a)?_=global.__minium_request_stack.get(a):(_=new Map,global.__minium_request_stack.set(a,_));var r,i=t.complete;t.complete=e=>{_.delete(r),0===_.size&&global.__minium_request_stack.delete(a),i&&i(e)};var n=e(t);return r=n&&n.uniqueId||Math.random(),_.set(r,Date.now()),n}})}}
