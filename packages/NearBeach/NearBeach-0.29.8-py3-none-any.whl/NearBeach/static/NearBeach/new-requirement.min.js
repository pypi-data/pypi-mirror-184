"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[7473],{7267:(e,t,n)=>{n.d(t,{Z:()=>h});var o,r=n(6252),i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],l=function(e){return-1!==i.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},s=0,a=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++s+String(t)},u=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},d=function(){return{listeners:[],scriptId:a("tiny-script"),scriptLoaded:!1}},c=(o=d(),{load:function(e,t,n){o.scriptLoaded?n():(o.listeners.push(n),e.getElementById(o.scriptId)||function(e,t,n,r){var i=t.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e,i.src=n;var l=function(){i.removeEventListener("load",l),o.listeners.forEach((function(e){return e()})),o.scriptLoaded=!0};i.addEventListener("load",l),t.head&&t.head.appendChild(i)}(o.scriptId,e,t))},reinitialize:function(){o=d()}}),p=function(){var e="undefined"!=typeof window?window:n.g;return e&&e.tinymce?e.tinymce:null},m={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},v=n(2262),y=function(){return y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},y.apply(this,arguments)};const h=(0,r.aZ)({props:m,setup:function(e,t){var n=e.init?y({},e.init):{},o=(0,v.BK)(e),i=o.disabled,s=o.modelValue,d=o.tagName,m=(0,v.iH)(null),h=null,g=e.id||a("tiny-vue"),f=e.init&&e.init.inline||e.inline,M=!!t.attrs["onUpdate:modelValue"],q=!0,S=e.initialValue?e.initialValue:"",b="",_=function(){var o,i,a,d=(o=q,M?function(){return(null==s?void 0:s.value)?s.value:""}:function(){return o?S:b}),c=y(y({},n),{readonly:e.disabled,selector:"#"+g,plugins:(i=n.plugins,a=e.plugins,u(i).concat(u(a))),toolbar:e.toolbar||n.toolbar,inline:f,setup:function(o){h=o,o.on("init",(function(n){return function(e,t,n,o,i,s){o.setContent(s()),n.attrs["onUpdate:modelValue"]&&function(e,t,n,o){var i=e.modelEvents?e.modelEvents:null,l=Array.isArray(i)?i.join(" "):i;(0,r.YP)(o,(function(t,o){n&&"string"==typeof t&&t!==o&&t!==n.getContent({format:e.outputFormat})&&n.setContent(t)})),n.on(l||"change input undo redo",(function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))}))}(t,n,o,i),function(e,t,n){Object.keys(t).filter(l).forEach((function(o){var r=t[o];"function"==typeof r&&("onInit"===o?r(e,n):n.on(o.substring(2),(function(e){return r(e,n)})))}))}(e,n.attrs,o)}(n,e,t,o,s,d)})),"function"==typeof n.setup&&n.setup(o)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(m.value)&&(m.value.style.visibility=""),p().init(c),q=!1};return(0,r.YP)(i,(function(e){null!==h&&h.setMode(e?"readonly":"design")})),(0,r.YP)(d,(function(e){var t;M||(b=h.getContent()),null===(t=p())||void 0===t||t.remove(h),(0,r.Y3)((function(){return _()}))})),(0,r.bv)((function(){if(null!==p())_();else if(m.value&&m.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"5",n=e.apiKey?e.apiKey:"no-api-key",o=null==e.tinymceScriptSrc?"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+t+"/tinymce.min.js":e.tinymceScriptSrc;c.load(m.value.ownerDocument,o,_)}})),(0,r.Jd)((function(){null!==p()&&p().remove(h)})),f||((0,r.dl)((function(){q||_()})),(0,r.se)((function(){var e;M||(b=h.getContent()),null===(e=p())||void 0===e||e.remove(h)}))),t.expose({rerender:function(e){var t;b=h.getContent(),null===(t=p())||void 0===t||t.remove(h),n=y(y({},n),e),(0,r.Y3)((function(){return _()}))}}),function(){return f?function(e,t,n,o){return e(o||"div",{id:t,ref:n})}(r.h,g,m,e.tagName):(0,r.h)("textarea",{id:g,visibility:"hidden",ref:m})}}})},3895:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var o=n(6252),r=n(9963);const i={class:"card"},l={class:"card-body"},s=(0,o._)("h1",null,"New Requirement",-1),a=(0,o._)("hr",null,null,-1),u={class:"row"},d=(0,o._)("div",{class:"col-md-4"},[(0,o._)("h2",null,"Description"),(0,o._)("p",{class:"text-instructions"}," Place a basic bird's eye view of the requirement description here. You will be able to break the requirement down into smaller components called 'Items' on the next page. ")],-1),c={class:"col-md-8",style:{"min-height":"610px"}},p={class:"form-group"},m={for:"id_requirement_title"},v=(0,o.Uk)("Requirement Title: "),y={key:0,class:"error"},h=(0,o._)("br",null,null,-1),g=(0,o.Uk)("Requirement Scope: "),f={key:0,class:"error"},M={key:1,class:"error"},q=(0,o._)("br",null,null,-1),S=["src"],b=(0,o._)("hr",null,null,-1),_=(0,o._)("hr",null,null,-1),k={class:"row"},w=(0,o._)("div",{class:"col-md-4"},[(0,o._)("h2",null,"Status"),(0,o._)("p",{class:"text-instructions"},"Set the Requirement Status and Type here.")],-1),C={class:"col-md-4"},$={class:"form-group"},U=(0,o.Uk)("Requirement Status "),L={key:0,class:"error"},x={class:"col-md-4"},D={class:"form-group"},R=(0,o.Uk)("Requirement Type "),P={key:0,class:"error"},E=(0,o._)("hr",null,null,-1),B=(0,o._)("hr",null,null,-1),A={class:"row submit-row"},T={class:"col-md-12"};var I=n(5169),O=n(7267),F=n(4178),V=n(1401),j=n(9860),N=n(4028),G=n(2587);const Z=n(9669),K={name:"NewRequirement",setup:()=>({v$:(0,N.ZP)()}),components:{editor:O.Z,GetStakeholders:F.Z,GroupPermissions:V.Z,NSelect:j.Z},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},staticUrl:{type:String,default:"/"},statusList:{type:Array,default:()=>[]},typeList:{type:Array,default:()=>[]},userGroupResults:{type:Array,default:()=>[]}},data:()=>({groupModel:"",requirementScopeModel:"",requirementTitleModel:"",stakeholderModel:"",statusFixList:[],statusModel:"",typeFixList:[],typeModel:""}),validations:{groupModel:{required:G.C1},requirementScopeModel:{required:G.C1,maxLength:(0,G.BS)(63e4)},requirementTitleModel:{required:G.C1},stakeholderModel:{required:G.C1},statusModel:{required:G.C1},typeModel:{required:G.C1}},methods:{submitNewRequirement:async function(){if(!await this.v$.$validate()&&(this.v$.groupModel.$error.length>0||this.v$.stakeholderModel.length>0||this.v$.requirementTitleModel.length>0||this.v$.requirementScopeModel.length>0||this.v$.statusModel.length>0||this.v$.typeModel.length>0))return document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",void new I.u_(document.getElementById("errorModal")).show();const e=new FormData;e.set("requirement_title",this.requirementTitleModel),e.set("requirement_scope",this.requirementScopeModel),e.set("organisation",this.stakeholderModel),e.set("requirement_status",this.statusModel),e.set("requirement_type",this.typeModel),this.groupModel.forEach(((t,n)=>{e.append("group_list",t)})),Z.post("save/",e).then((e=>{window.location.href=e.data})).catch((e=>{document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new requirement<hr>${e}`,new I.u_(document.getElementById("errorModal")).show()}))},updateGroupModel:function(e){this.groupModel=e},updateStakeholderModel:function(e){this.stakeholderModel=e}},mounted(){this.$store.commit({type:"updateUrl",rootUrl:this.rootUrl,staticUrl:this.staticUrl}),this.statusFixList=this.statusList.map((e=>({value:e.pk,label:e.fields.requirement_status}))),this.typeFixList=this.typeList.map((e=>({value:e.pk,label:e.fields.requirement_type})))}},W=(0,n(3744).Z)(K,[["render",function(e,t,n,I,O,F){const V=(0,o.up)("editor"),j=(0,o.up)("get-stakeholders"),N=(0,o.up)("n-select"),G=(0,o.up)("group-permissions");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",l,[s,a,(0,o._)("div",u,[(0,o.kq)(" Description "),d,(0,o._)("div",c,[(0,o._)("div",p,[(0,o._)("label",m,[v,!I.v$.requirementTitleModel.required&&I.v$.requirementTitleModel.$dirty?((0,o.wg)(),(0,o.iD)("span",y," Please suppy a title.")):(0,o.kq)("v-if",!0)]),(0,o.wy)((0,o._)("input",{id:"id_requirement_title",class:"form-control",name:"requirement_title",type:"text",required:"true",maxlength:"255","onUpdate:modelValue":t[0]||(t[0]=e=>O.requirementTitleModel=e)},null,512),[[r.vModelText,O.requirementTitleModel]])]),h,(0,o._)("label",null,[g,!I.v$.requirementScopeModel.required&&I.v$.requirementScopeModel.$dirty?((0,o.wg)(),(0,o.iD)("span",f," Please supply a scope.")):(0,o.kq)("v-if",!0),I.v$.requirementScopeModel.maxLength?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("span",M," Sorry - too many characters."))]),q,(0,o._)("img",{src:`${n.staticUrl}NearBeach/images/placeholder/body_text.svg`,class:"loader-image",alt:"loading image for Tinymce"},null,8,S),(0,o.Wm)(V,{init:{height:500,menubar:!1,plugins:["lists","table"],toolbar:["undo redo | formatselect | alignleft aligncenter alignright alignjustify","bold italic strikethrough underline backcolor | table | bullist numlist outdent indent | removeformat"]},content_css:!1,skin:!1,modelValue:O.requirementScopeModel,"onUpdate:modelValue":t[1]||(t[1]=e=>O.requirementScopeModel=e)},null,8,["modelValue"])])]),(0,o.kq)(" Stakeholder Organisation "),b,(0,o.Wm)(j,{onUpdate_stakeholder_model:t[2]||(t[2]=e=>F.updateStakeholderModel(e)),"is-dirty":I.v$.stakeholderModel.$dirty},null,8,["is-dirty"]),(0,o.kq)(" Status "),_,(0,o._)("div",k,[w,(0,o._)("div",C,[(0,o._)("div",$,[(0,o._)("label",null,[U,!I.v$.statusModel.required&&I.v$.statusModel.$dirty?((0,o.wg)(),(0,o.iD)("span",L," Please select a status.")):(0,o.kq)("v-if",!0)]),(0,o.Wm)(N,{options:O.statusFixList,label:"status",value:O.statusModel,"onUpdate:value":t[3]||(t[3]=e=>O.statusModel=e)},null,8,["options","value"])])]),(0,o._)("div",x,[(0,o._)("div",D,[(0,o._)("label",null,[R,!I.v$.typeModel.required&&I.v$.typeModel.$dirty?((0,o.wg)(),(0,o.iD)("span",P," Please select a type.")):(0,o.kq)("v-if",!0)]),(0,o.Wm)(N,{options:O.typeFixList,label:"type",value:O.typeModel,"onUpdate:value":t[4]||(t[4]=e=>O.typeModel=e)},null,8,["options","value"])])])]),(0,o.kq)(" Group Permissions "),E,(0,o.Wm)(G,{"group-results":n.groupResults,destination:"requirement","user-group-results":n.userGroupResults,onUpdate_group_model:t[5]||(t[5]=e=>F.updateGroupModel(e)),"is-dirty":I.v$.groupModel.$dirty},null,8,["group-results","user-group-results","is-dirty"]),(0,o.kq)(" Submit Button "),B,(0,o._)("div",A,[(0,o._)("div",T,[(0,o._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[6]||(t[6]=(...e)=>F.submitNewRequirement&&F.submitNewRequirement(...e))},"Create new Requirement")])])])])}]])}}]);