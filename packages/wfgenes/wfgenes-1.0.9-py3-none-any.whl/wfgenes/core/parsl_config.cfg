    
    if  resource['pool'] == 'slurm':  
        config = Config(
        executors=[
        HighThroughputExecutor(
                label="frontera_htex",
                address=address_by_hostname(),
                max_workers = int(resource['worker_per_node'])* int(resource['scale']),
                cores_per_worker = int(resource['cpu_per_node']) / int(resource['worker_per_node']), 
                provider=SlurmProvider(
                    channel=LocalChannel(),
                    cores_per_node = int(resource['cpu_per_node']),
                    nodes_per_block=int(resource['scale']),
                    mem_per_node = int(int(resource['memory'])/int(resource['scale'])),
                    init_blocks=1,
                    partition=str(resource['partition']),
                    walltime = str(resource['walltime']),
                    launcher=SrunLauncher(),
                ),
            )
        ],
            strategy = None
        )
        
    elif resource['pool'] == "local_threads":
        config = Config(
        executors=[
            ThreadPoolExecutor(
                label = "frontera_htex",
                max_threads=int(resource['threads_number']),  
        )
        ],
            strategy = None
        )
    elif resource['pool'] == "local_processes":
        config = Config(
        executors=[
            HighThroughputExecutor(
                label="frontera_htex",
                address=address_by_hostname(),
                max_workers=int(resource['processes_number']),
                cores_per_worker=int(resource['cpu_per_process']),
                provider=LocalProvider()
            )
        ],
        strategy=None
        )
    
    parsl.clear()
    parsl.load(config)